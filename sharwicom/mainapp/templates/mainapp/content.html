{% extends "mainapp/home-base.html" %}

{% load static %}

{% block body %}

<script defer src="{% static 'mainapp/js/star-rating.js' %}"></script>

<div class="content-wrapper">
    {% if success %}
        <div class="left">
            <div class="details">
                <span class="title">{{title}}</span>
                <span>{{type}}</span>
                <span>by {{author}}</span>
                <span class="description">{{description}}</span>
            </div>
            <div class="ratings">
                <div class="create">
                    <div class="title">
                        Your rating:
                    </div>
                    <div class="rating interactable" data-rating="{{user_rating}}" data-content_url_name="{{url_name}}">
                        <div class="s1">★</div>
                        <div class="s2">★</div>
                        <div class="s3">★</div>
                        <div class="s4">★</div>
                        <div class="s5">★</div>
                    </div>
                </div>
                <div class="total">
                    <div class="title">
                        Community rating:
                    </div>
                    <div class="rating community" data-rating="{{community_rating}}">
                        <div class="s1 partial-fill">★</div>
                        <div class="s2 partial-fill">★</div>
                        <div class="s3 partial-fill">★</div>
                        <div class="s4 partial-fill">★</div>
                        <div class="s5 partial-fill">★</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="right">
            <div class="reviews">
                {% for review in reviews %}
                    <div class="review">
                        <div class="author">
                            <span>
                                {% if review.author == request.user %}
                                    You
                                {% else %}
                                    {{review.author.username}}
                                {% endif %} 
                            </span>
                            <div class="rating review-rating" data-rating="{{review.rating}}">
                                <div class="s1">★</div>
                                <div class="s2">★</div>
                                <div class="s3">★</div>
                                <div class="s4">★</div>
                                <div class="s5">★</div>
                            </div>
                        </div>
                        <div class="summary">
                            {{review.summary}}
                        </div>
                        <div class="description">
                            {{review.description}}
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="buttons">
                {% if has_review %}
                    <button disabled>Write your review</button>
                    <a href="{% url 'edit_review' url_name %}"><button>Edit your existing review</button></a>
                {% else %}
                    <a href="{% url 'add_review' url_name %}"><button>Write your review</button></a>
                    <button disabled>Edit your existing review</button>
                {% endif %}
            </div>
        </div>
    {% else %}
        {{ message }}
    {% endif %}
</div>

{% endblock %}